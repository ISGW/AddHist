<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copy/Paste Bin</title>
    <!-- Include AWS SDK for JavaScript -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1024.0.min.js"></script>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h1>Copy/Paste Bin</h1>
    <form id="pasteForm">
        <label for="link">Link:</label>
        <input type="text" id="link" name="link" required>
        <br>
        <label for="description">Description:</label>
        <input type="text" id="description" name="description">
        <br>
        <button type="submit">Add Link</button>
    </form>
    <div id="linksContainer">
        <!-- Links will be dynamically added here -->
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pasteForm = document.getElementById('pasteForm');
            const linksContainer = document.getElementById('linksContainer');

            // Initialize AWS SDK
            AWS.config.update({
                region: 'us-east-1', // Replace with your preferred AWS region
                credentials: new AWS.Credentials('AKIAYS2NWDLAUABTBPFV', 'pcbcDZqSgYZGyjhls45IEIvvchL6NVGUlZmhGHkC')
            });
            const dynamoDB = new AWS.DynamoDB.DocumentClient();

            pasteForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const linkInput = document.getElementById('link');
                const descriptionInput = document.getElementById('description');
                const link = linkInput.value.trim();
                const description = descriptionInput.value.trim();

                if (link !== '') {
                    const linkObject = { id: Date.now().toString(), link, description };
                    saveLink(linkObject);
                    displayLinks();
                    linkInput.value = '';
                    descriptionInput.value = '';
                }
            });

            function saveLink(linkObject) {
                const params = {
                    TableName: 'LinksTable',
                    Item: {
                        id: linkObject.id,
                        link: linkObject.link,
                        description: linkObject.description
                    }
                };
                dynamoDB.put(params, (err, data) => {
                    if (err) {
                        console.error('Error saving link:', err);
                    } else {
                        console.log('Link saved successfully:', data);
                    }
                });
            }

            function displayLinks() {
                const params = {
                    TableName: 'LinksTable'
                };
                dynamoDB.scan(params, (err, data) => {
                    if (err) {
                        console.error('Error fetching links:', err);
                    } else {
                        linksContainer.innerHTML = '';
                        data.Items.forEach(linkObject => {
                            const linkItem = document.createElement('div');
                            linkItem.innerHTML = `
                                <a href="${linkObject.link}" target="_blank">${linkObject.description || linkObject.link}</a>
                                <button class="removeBtn" data-id="${linkObject.id}">Remove</button>
                            `;
                            linksContainer.appendChild(linkItem);
                        });

                        // Attach event listener for remove buttons
                        const removeButtons = document.querySelectorAll('.removeBtn');
                        removeButtons.forEach(btn => {
                            btn.addEventListener('click', (e) => {
                                const id = e.target.dataset.id;
                                removeLink(id);
                            });
                        });
                    }
                });
            }

            function removeLink(id) {
                const params = {
                    TableName: 'LinksTable',
                    Key: {
                        id: id
                    }
                };
                dynamoDB.delete(params, (err, data) => {
                    if (err) {
                        console.error('Error removing link:', err);
                    } else {
                        console.log('Link removed successfully:', data);
                        displayLinks();
                    }
                });
            }

            displayLinks();
        });
    </script>
</body>
</html>
